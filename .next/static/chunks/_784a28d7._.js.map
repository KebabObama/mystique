{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/mystique/hooks/use-friendship.ts"],"sourcesContent":["\"use client\";\n\nimport { io, type Socket } from \"socket.io-client\";\nimport { create } from \"zustand\";\n\ntype Message = {\n\tid?: string;\n\tusers: string[];\n\tsender: string;\n\ttext: string;\n};\n\ntype Friendship = {\n\tid: string;\n\tsender: string;\n\treceiver: string;\n\tstate: number;\n};\n\ntype SocketStore = {\n\tsocket: Socket | null;\n\tmessages: Message[];\n\tfriendships: Friendship[];\n\tconnect: (userId: string) => void;\n\tsendMessage: (msg: Omit<Message, \"id\">) => void;\n\trefreshMessages: () => void;\n\trefreshFriendships: () => void;\n\tchangeFriendship: (id: string, userId: string, state: number) => void;\n};\n\nexport const useFriendsStore = create<SocketStore>((set, get) => ({\n\tsocket: null,\n\tmessages: [],\n\tfriendships: [],\n\n\tconnect: (userId) => {\n\t\tif (get().socket) return; // already connected\n\n\t\tconst socket = io(\n\t\t\tprocess.env.NEXT_PUBLIC_COMM_URL ?? \"http://localhost:3001\",\n\t\t\t{\n\t\t\t\ttransports: [\"websocket\"],\n\t\t\t\twithCredentials: true,\n\t\t\t},\n\t\t);\n\n\t\tsocket.on(\"connect\", () => {\n\t\t\tsocket.emit(\"join\", userId);\n\t\t\tsocket.emit(\"get-messages\", userId);\n\t\t\tsocket.emit(\"get-friendships\", userId);\n\t\t});\n\n\t\tsocket.on(\"messages\", (msgs) => set({ messages: msgs }));\n\t\tsocket.on(\"receive-message\", (msg) =>\n\t\t\tset((state) => ({ messages: [...state.messages, msg] })),\n\t\t);\n\n\t\tsocket.on(\"friendships\", (friends) => set({ friendships: friends }));\n\n\t\tset({ socket });\n\t},\n\n\tsendMessage: (msg) => {\n\t\tconst socket = get().socket;\n\t\tif (!socket) return;\n\t\tsocket.emit(\"send-message\", msg);\n\t},\n\n\trefreshMessages: () => {\n\t\tconst socket = get().socket;\n\t\tconst userId = get().socket?.id;\n\t\tif (socket && userId) socket.emit(\"get-messages\", userId);\n\t},\n\n\trefreshFriendships: () => {\n\t\tconst socket = get().socket;\n\t\tconst userId = get().socket?.id;\n\t\tif (socket && userId) socket.emit(\"get-friendships\", userId);\n\t},\n\n\tchangeFriendship: (id, userId, state) => {\n\t\tconst socket = get().socket;\n\t\tif (socket) socket.emit(\"change-friendship\", id, userId, state);\n\t},\n}));\n"],"names":[],"mappings":";;;;AAuCG;AArCH;AACA;AAHA;;;AA8BO,MAAM,kBAAkB,IAAA,qJAAM,EAAc,CAAC,KAAK,MAAQ,CAAC;QACjE,QAAQ;QACR,UAAU,EAAE;QACZ,aAAa,EAAE;QAEf,SAAS,CAAC;YACT,IAAI,MAAM,MAAM,EAAE,QAAQ,oBAAoB;gBAG7C;YADD,MAAM,SAAS,IAAA,wLAAE,EAChB,CAAA,2GAAA,+CAAA,oCAAoC,yBACpC;gBACC,YAAY;oBAAC;iBAAY;gBACzB,iBAAiB;YAClB;YAGD,OAAO,EAAE,CAAC,WAAW;gBACpB,OAAO,IAAI,CAAC,QAAQ;gBACpB,OAAO,IAAI,CAAC,gBAAgB;gBAC5B,OAAO,IAAI,CAAC,mBAAmB;YAChC;YAEA,OAAO,EAAE,CAAC,YAAY,CAAC,OAAS,IAAI;oBAAE,UAAU;gBAAK;YACrD,OAAO,EAAE,CAAC,mBAAmB,CAAC,MAC7B,IAAI,CAAC,QAAU,CAAC;wBAAE,UAAU;+BAAI,MAAM,QAAQ;4BAAE;yBAAI;oBAAC,CAAC;YAGvD,OAAO,EAAE,CAAC,eAAe,CAAC,UAAY,IAAI;oBAAE,aAAa;gBAAQ;YAEjE,IAAI;gBAAE;YAAO;QACd;QAEA,aAAa,CAAC;YACb,MAAM,SAAS,MAAM,MAAM;YAC3B,IAAI,CAAC,QAAQ;YACb,OAAO,IAAI,CAAC,gBAAgB;QAC7B;QAEA,iBAAiB;gBAED;YADf,MAAM,SAAS,MAAM,MAAM;YAC3B,MAAM,UAAS,cAAA,MAAM,MAAM,cAAZ,kCAAA,YAAc,EAAE;YAC/B,IAAI,UAAU,QAAQ,OAAO,IAAI,CAAC,gBAAgB;QACnD;QAEA,oBAAoB;gBAEJ;YADf,MAAM,SAAS,MAAM,MAAM;YAC3B,MAAM,UAAS,cAAA,MAAM,MAAM,cAAZ,kCAAA,YAAc,EAAE;YAC/B,IAAI,UAAU,QAAQ,OAAO,IAAI,CAAC,mBAAmB;QACtD;QAEA,kBAAkB,CAAC,IAAI,QAAQ;YAC9B,MAAM,SAAS,MAAM,MAAM;YAC3B,IAAI,QAAQ,OAAO,IAAI,CAAC,qBAAqB,IAAI,QAAQ;QAC1D;IACD,CAAC","debugId":null}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/mystique/app/%28layout%29/%28wrapper%29/friends/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useFriendsStore } from \"@/hooks/use-friendship\";\n\nexport default ({ userId }: { userId: string }) => {\n\tconst { messages, connect, sendMessage } = useFriendsStore();\n\n\tuseEffect(() => {\n\t\tconnect(userId);\n\t}, [userId, connect]);\n\n\treturn (\n\t\t<div className=\"space-y-2\">\n\t\t\t{messages.map((m) => (\n\t\t\t\t<div key={m.id}>{m.text}</div>\n\t\t\t))}\n\t\t\t<Button\n\t\t\t\tonClick={() =>\n\t\t\t\t\tsendMessage({\n\t\t\t\t\t\tusers: [userId, \"otherUser\"],\n\t\t\t\t\t\tsender: userId,\n\t\t\t\t\t\ttext: \"Hi!\",\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t>\n\t\t\t\tSend Test\n\t\t\t</Button>\n\t\t</div>\n\t);\n};\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;0CAMe;QAAC,EAAE,MAAM,EAAsB;;IAC7C,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE,WAAW,EAAE,GAAG,IAAA,gJAAe;IAE1D,IAAA,0KAAS;qBAAC;YACT,QAAQ;QACT;oBAAG;QAAC;QAAQ;KAAQ;IAEpB,qBACC,6LAAC;QAAI,WAAU;;YACb,SAAS,GAAG,CAAC,CAAC,kBACd,6LAAC;8BAAgB,EAAE,IAAI;mBAAb,EAAE,EAAE;;;;;0BAEf,6LAAC,wIAAM;gBACN,SAAS,IACR,YAAY;wBACX,OAAO;4BAAC;4BAAQ;yBAAY;wBAC5B,QAAQ;wBACR,MAAM;oBACP;0BAED;;;;;;;;;;;;AAKJ;;QAxB4C,gJAAe","debugId":null}}]
}